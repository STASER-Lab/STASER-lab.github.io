{{- $title := .Get "title" | default (i18n "contact_title") -}}
<section id="contact" class="section rad-animation-group section--padding">
  <div class="container">
    <div class="row rad-fade-down">
      <div class="col-12">
        <h2 class="section__title">{{ $title }}</h2>
      </div>
    </div>

    <div class="row">
      <div class="col-12 col-md-6">
        {{ with .Inner }}
          <div class="mb-4 content">
            {{ . | markdownify }}
          </div>
        {{ end }}
      </div>

      <div class="col-12 col-md-6">
        <form id="contactForm" action="https://formspree.io/f/mpwjvqay" method="POST" class="contact-form">
          <div class="form-group mb-3">
            <label for="name">{{ i18n "form_name" }}</label>
            <input type="text" id="name" name="name" class="form-control"
                   placeholder='{{ i18n "form_name_placeholder" }}' required>
          </div>

          <div class="form-group mb-3">
            <label for="email">{{ i18n "form_email" }}</label>
            <input type="email" id="email" name="email" class="form-control"
                   placeholder='{{ i18n "form_email_placeholder" }}' required>
          </div>

          <div class="form-group mb-3">
            <label for="message">{{ i18n "form_message" }}</label>
            <textarea id="message" name="message" rows="5" class="form-control"
                      placeholder='{{ i18n "form_message_placeholder" }}' required></textarea>
          </div>

          <input type="hidden" name="_subject" value="{{ i18n "form_subject_default" }}">
          <input type="text" name="_gotcha" style="display:none">

          <button type="submit" class="btn btn-primary">{{ i18n "form_submit" }}</button>
        </form>

        <!-- Success / error messages -->
        <div id="formResponse" class="mt-3" style="display:none;"></div>
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const form = document.getElementById("contactForm");
  const responseDiv = document.getElementById("formResponse");

  form.addEventListener("submit", async function(e) {
    e.preventDefault();
    const formData = new FormData(form);
    try {
      const res = await fetch(form.action, {
        method: "POST",
        body: formData,
        headers: { "Accept": "application/json" }
      });
      if (res.ok) {
        form.reset();
        responseDiv.style.display = "block";
        responseDiv.innerHTML = "<div class='alert alert-success'>{{ i18n "form_success_message" }}</div>";
      } else {
        responseDiv.style.display = "block";
        responseDiv.innerHTML = "<div class='alert alert-danger'>{{ i18n "form_error_message" }}</div>";
      }
    } catch (err) {
      responseDiv.style.display = "block";
      responseDiv.innerHTML = "<div class='alert alert-danger'>{{ i18n "form_error_message" }}</div>";
    }
  });
});
</script>
